#+TITLE: Lab export Clojure scripts
:PROPERTIES:
:DOC_ID: futon4-47bd56ec9094
:ENTRY_ID: futon4-47bd56ec9094::org
:VERSION: org
:OUTLINE_PATH: Lab export Clojure scripts
:PATH_STRING: Lab export Clojure scripts
:REPLACES:
:END:

* Overview
The lab export scripts convert session logs into structured artifacts under
`lab/`. They generate raw JSON, Org stubs, and trace files so lab sessions can
be browsed and summarized alongside other Arxana materials.

* Scripts and roles
- `futon3/dev/lab-export.clj` reads a Codex session JSONL (for example, from
  `lab/raw-stream/`) and writes `lab/raw`, `lab/stubs`, and `lab/trace` entries.
- `futon3/dev/lab-export-claude.clj` does the same for Claude session JSONL,
  including tool-use extraction when available.
- `futon3/dev/lab-summarize.clj` uses an LLM to generate a structured Org stub
  from a raw session JSON entry.
- `futon3/dev/lab-summary.clj` generates a concise session summary in
  org/json/text formats from `lab/raw`.
- `futon3/dev/musn_stream.clj` is a live run companion that translates Codex
  JSON streams into MUSN turn calls (not a lab export, but part of the same
  pipeline).

* Running the scripts
All scripts accept CLI flags (see the usage output at the top of each file).
Typical usage includes `--session-file` for exports and `--raw` for summaries.
Most scripts support `--dry-run` to preview outputs without writing.

* Integration points
Exports are stored under `lab/raw`, `lab/stubs`, `lab/trace`, and `lab/summaries`.
These outputs feed the lab notebook browser and can be promoted into docbook
entries as part of the documentation pipeline. MUSN turn lifecycle logs are
stored separately under `lab/musn/` by `futon3.musn.http` and can be
cross-referenced with lab exports during review.
